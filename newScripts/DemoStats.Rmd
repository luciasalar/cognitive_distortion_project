---
title: "Basic_stats"
author: "lushi"
date: "26/03/2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#This file shows the basic demographic information from the annotated users (N= 77)
```{r cars}
library(tidyverse)
library(stargazer)
```
Id80PerRetained.csv userid with more than 80% posts retained (we removed posts with foreign language that we can't understand)
We have 70 participants in total after removing them 
Continous variables
Note: posts count and day spread in here is from the whole sample. Not our subset sample.
```{r pressure, echo=FALSE}
# setwd('/Users/lucia/phd_work/cognitive_distortion/') 
# '/home/lucia/phd_work/mypersonality_data/cognitive_distortion/'
allData <- read.csv('/Users/lucia/phd_work/cognitive_distortion/data/important_data/user_scale_post_time2.csv')
allData <- subset(allData, age > 17 | is.na(age))
#merge with annotated users
users <- read.csv('/Users/lucia/phd_work/cognitive_distortion/data/important_data/twoM_newLabels80P.csv')
users <- users[!duplicated(users$userid), ]
users <- users$userid
AnnotatedUsersInf <- allData[allData$userid %in% users,]
#select continous values
SelData <- AnnotatedUsersInf[, c(5:6, 14, 24, 26:30, 36:37)]
#summa <- summary(SelData)
#summa[1:5,]
#stargazer(summa[1:2,],type = "html", summary = FALSE, rownames = FALSE)
data <- AnnotatedUsersInf[, c('userid','CESD_sum', 'swl')]
#write.csv(data, '/Users/lucia/phd_work/cognitive_distortion/data/important_data/FinalSampleUsers.csv')

stargazer(SelData)


```

Check skewness of variables
```{r }
shapiro.test(AnnotatedUsersInf$ope)
shapiro.test(AnnotatedUsersInf$agr)
shapiro.test(AnnotatedUsersInf$ext)
shapiro.test(AnnotatedUsersInf$con)
shapiro.test(AnnotatedUsersInf$neu)
shapiro.test(AnnotatedUsersInf$swl)
shapiro.test(AnnotatedUsersInf$network_size)
shapiro.test(AnnotatedUsersInf$CESD_sum)

plot(density(AnnotatedUsersInf$ope)) # peaks at around 4 and 4.6
plot(density(AnnotatedUsersInf$swl)) # peaks at around 3 and 4.5
```
CESD cutoff 21 
```{r}
high <- SelData[SelData$CESD_sum > 21,]
low <- SelData[SelData$CESD_sum <= 21,]

high$group <- 1
low$group <- 2
both <- rbind(high,low)

stargazer(high, digits = 2, omit.summary.stat = c("min","max","n"))
stargazer(low, digits = 2, omit.summary.stat = c("min","max","n"))

wilcox.test(swl ~ both$group, data = both)
wilcox.test(ope ~ both$group, data = both)
wilcox.test(agr ~ both$group, data = both)
wilcox.test(neu ~ both$group, data = both)
wilcox.test(con ~ both$group, data = both)
wilcox.test(ext ~ both$group, data = both)



```




```{r }
p1  <- boxplot(SelData[, c(1:2, 4)], data=SelData, main="Demographic Informtation", names=names(SelData[, c(1:2, 4)]))
p2 <- boxplot(SelData[, c(3, 11)], data=SelData, main="Demographic Informtation", names=names(SelData[, c(3, 11)]))
p3 <- boxplot(SelData[, c(5:9)], data=SelData, main="Demographic Informtation", names=names(SelData[, c(5:9)]))
```

Categorical variables
Percentage of people in specific demographic groups
The acronyms are standard locale / language acronyms.

```{r }
SelDataCat <- AnnotatedUsersInf[, c(9:10, 12, 23)]
prop.table(table(SelDataCat$marital_status))
prop.table(table(SelDataCat$ethnicity))
prop.table(table(SelDataCat$gender))
prop.table(table(SelDataCat$locale))
```

gender female = 1, male = 0
```{r }
# cut off score as 16
print('16 cutoff')
table(AnnotatedUsersInf$gender, AnnotatedUsersInf$CESD_sum > 16)
print('21 cutoff')
table(AnnotatedUsersInf$gender, AnnotatedUsersInf$CESD_sum > 21)
print('16 cutoff')
table(AnnotatedUsersInf$ethnicity, AnnotatedUsersInf$CESD_sum > 16)
print('21 cutoff')
table(AnnotatedUsersInf$ethnicity, AnnotatedUsersInf$CESD_sum > 21)
print('16 cutoff')
table(AnnotatedUsersInf$marital_status, AnnotatedUsersInf$CESD_sum > 16)
print('21 cutoff')
table(AnnotatedUsersInf$marital_status, AnnotatedUsersInf$CESD_sum > 21)

```



